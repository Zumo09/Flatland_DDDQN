Weigh and Biases Configuration
                    n_episodes	:	2000
                    env_config	:	0
         n_evaluation_episodes	:	25
           checkpoint_interval	:	100
                     eps_start	:	1.0
                       eps_end	:	0.01
                     eps_decay	:	0.998
        invalid_action_penalty	:	-1.0
                  step_penalty	:	-1.5
                 global_reward	:	5.0
                  stop_penalty	:	0.0
                 start_penalty	:	0.0
                   buffer_size	:	100000
               buffer_min_size	:	0
                    batch_size	:	128
                         gamma	:	0.98
                           tau	:	0.001
                 learning_rate	:	8e-05
                 hidden_size_1	:	256
                 hidden_size_2	:	128
                 hidden_size_3	:	32
                  update_every	:	16
                     num_heads	:	1
                        p_head	:	1
                   training_id	:	210921163305
                      n_agents	:	3
                         x_dim	:	35
                         y_dim	:	35
                      n_cities	:	2
      max_rails_between_cities	:	2
             max_rails_in_city	:	3
              malfunction_rate	:	0.02
                          seed	:	0
        observation_tree_depth	:	2
    observation_max_path_depth	:	30
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
state size : 63
ğŸš‰ Training 3 trains on 35x35 grid for 2000 episodes, evaluating on 25 episodes every 100 episodes. Training id '210921163305'.
C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:4211: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable_debug_mode()`.
  warnings.warn(
ğŸš‚ Episode    0	ğŸ† Score: -0.549 (Avg: -0.995)	ğŸ’¯ Done:  66.67% (Avg:   0.67%)	ğŸ² Epsilon: 0.998 	ğŸ”€ Action Probs: â†» 0.000 â† 0.002 â†‘ 0.978 â†’ 0.021 â—¼ 0.000
C:\Users\emman\.conda\envs\main-env\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
C:\Users\emman\.conda\envs\main-env\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
	âœ… Eval: score -0.999 done  40.00%
C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:4211: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable_debug_mode()`.
  warnings.warn(
ğŸš‚ Episode    1	ğŸ† Score: -1.497 (Avg: -1.001)	ğŸ’¯ Done:   0.00% (Avg:   0.66%)	ğŸ² Epsilon: 0.996 	ğŸ”€ Action Probs: â†» 0.000 â† 0.002 â†‘ 0.997 â†’ 0.002 â—¼ 0.000
ğŸš‚ Episode    2	ğŸ† Score: -0.382 (Avg: -0.994)	ğŸ’¯ Done: 100.00% (Avg:   1.65%)	ğŸ² Epsilon: 0.994 	ğŸ”€ Action Probs: â†» 0.000 â† 0.071 â†‘ 0.816 â†’ 0.113 â—¼ 0.000
ğŸš‚ Episode    3	ğŸ† Score: -1.077 (Avg: -0.995)	ğŸ’¯ Done:  33.33% (Avg:   1.97%)	ğŸ² Epsilon: 0.992 	ğŸ”€ Action Probs: â†» 0.000 â† 0.006 â†‘ 0.993 â†’ 0.001 â—¼ 0.000
ğŸš‚ Episode    4	ğŸ† Score: -1.497 (Avg: -1.000)	ğŸ’¯ Done:   0.00% (Avg:   1.95%)	ğŸ² Epsilon: 0.990 	ğŸ”€ Action Probs: â†» 0.000 â† 0.025 â†‘ 0.876 â†’ 0.030 â—¼ 0.069
ğŸš‚ Episode    5	ğŸ† Score: -1.497 (Avg: -1.005)	ğŸ’¯ Done:   0.00% (Avg:   1.93%)	ğŸ² Epsilon: 0.988 	ğŸ”€ Action Probs: â†» 0.000 â† 0.010 â†‘ 0.948 â†’ 0.041 â—¼ 0.000
ğŸš‚ Episode    6	ğŸ† Score: -0.799 (Avg: -1.003)	ğŸ’¯ Done:  66.67% (Avg:   2.58%)	ğŸ² Epsilon: 0.986 	ğŸ”€ Action Probs: â†» 0.000 â† 0.007 â†‘ 0.964 â†’ 0.029 â—¼ 0.000
ğŸš‚ Episode    7	ğŸ† Score: -1.497 (Avg: -1.008)	ğŸ’¯ Done:   0.00% (Avg:   2.55%)	ğŸ² Epsilon: 0.984 	ğŸ”€ Action Probs: â†» 0.000 â† 0.000 â†‘ 0.996 â†’ 0.004 â—¼ 0.000
ğŸš‚ Episode    8	ğŸ† Score: -1.074 (Avg: -1.009)	ğŸ’¯ Done:  33.33% (Avg:   2.86%)	ğŸ² Epsilon: 0.982 	ğŸ”€ Action Probs: â†» 0.000 â† 0.263 â†‘ 0.723 â†’ 0.014 â—¼ 0.000
ğŸš‚ Episode    9	ğŸ† Score: -1.191 (Avg: -1.011)	ğŸ’¯ Done:  33.33% (Avg:   3.17%)	ğŸ² Epsilon: 0.980 	ğŸ”€ Action Probs: â†» 0.000 â† 0.106 â†‘ 0.882 â†’ 0.012 â—¼ 0.000
ğŸš‚ Episode   10	ğŸ† Score: -1.497 (Avg: -1.015)	ğŸ’¯ Done:   0.00% (Avg:   3.13%)	ğŸ² Epsilon: 0.978 	ğŸ”€ Action Probs: â†» 0.000 â† 0.000 â†‘ 0.995 â†’ 0.005 â—¼ 0.000
ğŸš‚ Episode   11	ğŸ† Score: -1.230 (Avg: -1.018)	ğŸ’¯ Done:  33.33% (Avg:   3.44%)	ğŸ² Epsilon: 0.976 	ğŸ”€ Action Probs: â†» 0.000 â† 0.048 â†‘ 0.377 â†’ 0.042 â—¼ 0.533
ğŸš‚ Episode   12	ğŸ† Score: -1.497 (Avg: -1.022)	ğŸ’¯ Done:   0.00% (Avg:   3.40%)	ğŸ² Epsilon: 0.974 	ğŸ”€ Action Probs: â†» 0.000 â† 0.000 â†‘ 0.795 â†’ 0.063 â—¼ 0.142
ğŸš‚ Episode   13	ğŸ† Score: -1.349 (Avg: -1.026)	ğŸ’¯ Done:  33.33% (Avg:   3.70%)	ğŸ² Epsilon: 0.972 	ğŸ”€ Action Probs: â†» 0.000 â† 0.006 â†‘ 0.471 â†’ 0.101 â—¼ 0.422
ğŸš‚ Episode   14	ğŸ† Score: -1.497 (Avg: -1.030)	ğŸ’¯ Done:   0.00% (Avg:   3.66%)	ğŸ² Epsilon: 0.970 	ğŸ”€ Action Probs: â†» 0.000 â† 0.000 â†‘ 0.979 â†’ 0.021 â—¼ 0.000
ğŸš‚ Episode   15	ğŸ† Score: -1.052 (Avg: -1.031)	ğŸ’¯ Done:  33.33% (Avg:   3.96%)	ğŸ² Epsilon: 0.968 	ğŸ”€ Action Probs: â†» 0.000 â† 0.383 â†‘ 0.208 â†’ 0.409 â—¼ 0.000
ğŸš‚ Episode   16	ğŸ† Score: -1.069 (Avg: -1.031)	ğŸ’¯ Done:  33.33% (Avg:   4.25%)	ğŸ² Epsilon: 0.967 	ğŸ”€ Action Probs: â†» 0.000 â† 0.012 â†‘ 0.921 â†’ 0.067 â—¼ 0.000
Traceback (most recent call last):
  File "C:\Users\emman\OneDrive\Scuola\Unibo\DL - Deep Learning\Project\Repo\Flatland_DDDQN\multi_agent_training_4act_bootstrap.py", line 396, in <module>
    train_agent(wandb.config)
  File "C:\Users\emman\OneDrive\Scuola\Unibo\DL - Deep Learning\Project\Repo\Flatland_DDDQN\multi_agent_training_4act_bootstrap.py", line 189, in train_agent
    policy.step(agent_prev_obs[agent], agent_prev_action[agent], all_rewards[agent],
  File "C:\Users\emman\OneDrive\Scuola\Unibo\DL - Deep Learning\Project\Repo\Flatland_DDDQN\components\bdddqn_policy.py", line 80, in step
    self._learn()
  File "C:\Users\emman\OneDrive\Scuola\Unibo\DL - Deep Learning\Project\Repo\Flatland_DDDQN\components\bdddqn_policy.py", line 122, in _learn
    self.qnetwork_local.fit(np.array(train_states), y={head_name: np.array(train_targets)},
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\keras\engine\training.py", line 1134, in fit
    data_handler = data_adapter.get_data_handler(
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\keras\engine\data_adapter.py", line 1383, in get_data_handler
    return DataHandler(*args, **kwargs)
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\keras\engine\data_adapter.py", line 1138, in __init__
    self._adapter = adapter_cls(
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\keras\engine\data_adapter.py", line 286, in __init__
    indices_dataset = indices_dataset.map(permutation).prefetch(1)
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py", line 1861, in map
    return MapDataset(self, map_func, preserve_cardinality=True)
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py", line 4981, in __init__
    self._map_func = StructuredFunctionWrapper(
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py", line 4218, in __init__
    self._function = fn_factory()
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\eager\function.py", line 3150, in get_concrete_function
    graph_function = self._get_concrete_function_garbage_collected(
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\eager\function.py", line 3116, in _get_concrete_function_garbage_collected
    graph_function, _ = self._maybe_define_function(args, kwargs)
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\eager\function.py", line 3463, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\eager\function.py", line 3298, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\framework\func_graph.py", line 1007, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py", line 4195, in wrapped_fn
    ret = wrapper_helper(*args)
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py", line 4125, in wrapper_helper
    ret = autograph.tf_convert(self._func, ag_ctx)(*nested_args)
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\autograph\impl\api.py", line 692, in wrapper
    return converted_call(f, args, kwargs, options=options)
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\autograph\impl\api.py", line 382, in converted_call
    return _call_unconverted(f, args, kwargs, options)
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\autograph\impl\api.py", line 463, in _call_unconverted
    return f(*args, **kwargs)
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\keras\engine\data_adapter.py", line 277, in permutation
    indices = tf.range(num_samples, dtype=tf.int64)
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\util\dispatch.py", line 206, in wrapper
    return target(*args, **kwargs)
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\ops\math_ops.py", line 2064, in range
    return gen_math_ops._range(start, limit, delta, name=name)
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\ops\gen_math_ops.py", line 7368, in _range
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 377, in _apply_op_helper
    with g.as_default(), ops.name_scope(name) as scope:
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\framework\func_graph.py", line 369, in as_default
    outer_cm = super(FuncGraph, self).as_default()
  File "C:\Users\emman\.conda\envs\main-env\lib\site-packages\tensorflow\python\framework\ops.py", line 3975, in as_default
    def as_default(self):
KeyboardInterrupt