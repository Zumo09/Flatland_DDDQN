Weigh and Biases Configuration
                    n_episodes	:	3000
                    env_config	:	0
         n_evaluation_episodes	:	25
           checkpoint_interval	:	100
                     eps_start	:	1.0
                       eps_end	:	0.01
                     eps_decay	:	0.998
        invalid_action_penalty	:	-1.0
                  step_penalty	:	-1.5
                 global_reward	:	5.0
                  stop_penalty	:	0.0
                 start_penalty	:	0.0
                   buffer_size	:	100000
               buffer_min_size	:	0
                    batch_size	:	128
                         gamma	:	0.98
                           tau	:	0.001
                 learning_rate	:	0.0001
                 hidden_size_1	:	256
                 hidden_size_2	:	64
                 hidden_size_3	:	32
                  update_every	:	8
                     num_heads	:	4
                        p_head	:	0.5
                   training_id	:	210923213346
                      n_agents	:	3
                         x_dim	:	35
                         y_dim	:	35
                      n_cities	:	2
      max_rails_between_cities	:	2
             max_rails_in_city	:	3
              malfunction_rate	:	0.02
                          seed	:	0
        observation_tree_depth	:	2
    observation_max_path_depth	:	30
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
DEPRECATED - RailEnv arg: malfunction_and_process_data - use malfunction_generator
state size : 63
ğŸš‰ Training 3 trains on 35x35 grid for 3000 episodes, evaluating on 25 episodes every 100 episodes. Training id '210923213346'.
C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.
  "Even though the `tf.config.experimental_run_functions_eagerly` "
ğŸš‚ Episode    0	ğŸ† Score: -1.497 (Avg: -1.005)	ğŸ’¯ Done:   0.00% (Avg:   0.00%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.000 â†‘ 0.002 â†’ 0.000 â—¼ 0.998
C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.

ğŸš‚ Episode    0	ğŸ† Score: -1.497 (Avg: -1.005)	ğŸ’¯ Done:   0.00% (Avg:   0.00%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.000 â†‘ 0.002 â†’ 0.000 â—¼ 0.998 	âœ… Eval: score -1.403 done   8.00%




































































































ğŸš‚ Episode  100	ğŸ† Score: -1.069 (Avg: -1.106)	ğŸ’¯ Done:  33.33% (Avg:  18.25%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.012 â†‘ 0.012 â†’ 0.069 â—¼ 0.907 	âœ… Eval: score -1.237 done  20.00%
C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.
  "Even though the `tf.config.experimental_run_functions_eagerly` "



































































































ğŸš‚ Episode  200	ğŸ† Score: -1.029 (Avg: -0.919)	ğŸ’¯ Done:  33.33% (Avg:  42.66%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.119 â†‘ 0.079 â†’ 0.135 â—¼ 0.667
C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.

ğŸš‚ Episode  200	ğŸ† Score: -1.029 (Avg: -0.919)	ğŸ’¯ Done:  33.33% (Avg:  42.66%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.119 â†‘ 0.079 â†’ 0.135 â—¼ 0.667 	âœ… Eval: score -1.141 done  28.00%




































































































ğŸš‚ Episode  300	ğŸ† Score: -1.087 (Avg: -0.734)	ğŸ’¯ Done:  33.33% (Avg:  58.39%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.395 â†‘ 0.346 â†’ 0.198 â—¼ 0.062 	âœ… Eval: score -0.501 done  73.33%
C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.
  "Even though the `tf.config.experimental_run_functions_eagerly` "



































































































ğŸš‚ Episode  400	ğŸ† Score: -1.038 (Avg: -0.569)	ğŸ’¯ Done:  33.33% (Avg:  71.88%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.026 â†‘ 0.040 â†’ 0.087 â—¼ 0.847
C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.

ğŸš‚ Episode  400	ğŸ† Score: -1.038 (Avg: -0.569)	ğŸ’¯ Done:  33.33% (Avg:  71.88%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.026 â†‘ 0.040 â†’ 0.087 â—¼ 0.847 	âœ… Eval: score -0.572 done  69.33%




































































































ğŸš‚ Episode  500	ğŸ† Score: -0.224 (Avg: -0.433)	ğŸ’¯ Done: 100.00% (Avg:  80.94%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.684 â†‘ 0.056 â†’ 0.260 â—¼ 0.000 	âœ… Eval: score -0.489 done  74.67%
C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.
  "Even though the `tf.config.experimental_run_functions_eagerly` "




































































































ğŸš‚ Episode  600	ğŸ† Score: -0.565 (Avg: -0.461)	ğŸ’¯ Done:  66.67% (Avg:  78.41%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.026 â†‘ 0.093 â†’ 0.005 â—¼ 0.877 	âœ… Eval: score -0.355 done  85.33%
C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.
  "Even though the `tf.config.experimental_run_functions_eagerly` "



































































































ğŸš‚ Episode  700	ğŸ† Score: -0.129 (Avg: -0.407)	ğŸ’¯ Done: 100.00% (Avg:  82.03%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.168 â†‘ 0.528 â†’ 0.304 â—¼ 0.000
C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.

ğŸš‚ Episode  700	ğŸ† Score: -0.129 (Avg: -0.407)	ğŸ’¯ Done: 100.00% (Avg:  82.03%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.168 â†‘ 0.528 â†’ 0.304 â—¼ 0.000 	âœ… Eval: score -0.485 done  77.33%



































































































ğŸš‚ Episode  800	ğŸ† Score: -0.187 (Avg: -0.381)	ğŸ’¯ Done: 100.00% (Avg:  84.57%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.132 â†‘ 0.553 â†’ 0.126 â—¼ 0.189
C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.

ğŸš‚ Episode  800	ğŸ† Score: -0.187 (Avg: -0.381)	ğŸ’¯ Done: 100.00% (Avg:  84.57%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.132 â†‘ 0.553 â†’ 0.126 â—¼ 0.189 	âœ… Eval: score -0.410 done  80.00%



































































































ğŸš‚ Episode  900	ğŸ† Score: -0.115 (Avg: -0.386)	ğŸ’¯ Done: 100.00% (Avg:  83.63%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.854 â†‘ 0.035 â†’ 0.111 â—¼ 0.000
C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.

ğŸš‚ Episode  900	ğŸ† Score: -0.115 (Avg: -0.386)	ğŸ’¯ Done: 100.00% (Avg:  83.63%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.854 â†‘ 0.035 â†’ 0.111 â—¼ 0.000 	âœ… Eval: score -0.333 done  86.67%




































































































ğŸš‚ Episode 1000	ğŸ† Score: -1.497 (Avg: -0.392)	ğŸ’¯ Done:   0.00% (Avg:  83.03%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.592 â†‘ 0.096 â†’ 0.312 â—¼ 0.000 	âœ… Eval: score -0.394 done  80.00%
C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.
  "Even though the `tf.config.experimental_run_functions_eagerly` "




































































































ğŸš‚ Episode 1100	ğŸ† Score: -0.121 (Avg: -0.395)	ğŸ’¯ Done: 100.00% (Avg:  82.28%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.815 â†‘ 0.040 â†’ 0.146 â—¼ 0.000 	âœ… Eval: score -0.307 done  88.00%
C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.
  "Even though the `tf.config.experimental_run_functions_eagerly` "



































































































ğŸš‚ Episode 1200	ğŸ† Score: -0.176 (Avg: -0.325)	ğŸ’¯ Done: 100.00% (Avg:  87.99%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.533 â†‘ 0.192 â†’ 0.276 â—¼ 0.000
C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.

ğŸš‚ Episode 1200	ğŸ† Score: -0.176 (Avg: -0.325)	ğŸ’¯ Done: 100.00% (Avg:  87.99%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.533 â†‘ 0.192 â†’ 0.276 â—¼ 0.000 	âœ… Eval: score -0.223 done  94.67%



































































































ğŸš‚ Episode 1300	ğŸ† Score: -1.497 (Avg: -0.357)	ğŸ’¯ Done:   0.00% (Avg:  85.78%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.083 â†‘ 0.095 â†’ 0.787 â—¼ 0.036
C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.

ğŸš‚ Episode 1300	ğŸ† Score: -1.497 (Avg: -0.357)	ğŸ’¯ Done:   0.00% (Avg:  85.78%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.083 â†‘ 0.095 â†’ 0.787 â—¼ 0.036 	âœ… Eval: score -0.211 done  94.67%




































































































ğŸš‚ Episode 1400	ğŸ† Score: -0.136 (Avg: -0.363)	ğŸ’¯ Done: 100.00% (Avg:  84.92%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.217 â†‘ 0.302 â†’ 0.442 â—¼ 0.039 	âœ… Eval: score -0.355 done  84.00%
C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.
  "Even though the `tf.config.experimental_run_functions_eagerly` "



































































































ğŸš‚ Episode 1500	ğŸ† Score: -0.158 (Avg: -0.399)	ğŸ’¯ Done: 100.00% (Avg:  83.52%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.551 â†‘ 0.218 â†’ 0.231 â—¼ 0.000
C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.

ğŸš‚ Episode 1500	ğŸ† Score: -0.158 (Avg: -0.399)	ğŸ’¯ Done: 100.00% (Avg:  83.52%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.551 â†‘ 0.218 â†’ 0.231 â—¼ 0.000 	âœ… Eval: score -0.320 done  88.00%

ğŸš‚ Episode 1502	ğŸ† Score: -1.027 (Avg: -0.403)	ğŸ’¯ Done:  33.33% (Avg:  83.18%)	ğŸ”€ Action Probs: â†» 0.000 â† 0.252 â†‘ 0.730 â†’ 0.018 â—¼ 0.000
Traceback (most recent call last):
  File "D:/Users/Zumo/Documents/UNIVERSITÃ€/AI/DL/Flatland_DDDQN/multi_agent_training_4act_bootstrap.py", line 393, in <module>
  File "D:/Users/Zumo/Documents/UNIVERSITÃ€/AI/DL/Flatland_DDDQN/multi_agent_training_4act_bootstrap.py", line 181, in train_agent
    for agent in train_env.get_agent_handles():
  File "C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\flatland\envs\rail_env.py", line 590, in step
    return self._get_observations(), self.rewards_dict, self.dones, info_dict
  File "C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\flatland\envs\rail_env.py", line 1070, in _get_observations
    self.obs_dict = self.obs_builder.get_many(list(range(self.get_num_agents())))
  File "C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\flatland\envs\observations.py", line 109, in get_many
    observations = super().get_many(handles)
  File "C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\flatland\core\env_observation_builder.py", line 55, in get_many
    observations[h] = self.get(h)
  File "D:\Users\Zumo\Documents\UNIVERSITÃ€\AI\DL\Flatland_DDDQN\components\observations.py", line 13, in get
    obs = self.tree_encoding(obs)
  File "D:\Users\Zumo\Documents\UNIVERSITÃ€\AI\DL\Flatland_DDDQN\components\observations.py", line 175, in tree_encoding
    def sub_tree_encoding(self, tree_decomposed, final_array, tree_dict):
  File "D:\Users\Zumo\Documents\UNIVERSITÃ€\AI\DL\Flatland_DDDQN\components\observations.py", line 198, in sub_tree_encoding
  File "D:\Users\Zumo\Documents\UNIVERSITÃ€\AI\DL\Flatland_DDDQN\components\observations.py", line 187, in sub_tree_encoding
    final_array = np.append(final_array, tree_dict[sub_tree[0]])  # append the encoded direction
  File "<__array_function__ internals>", line 6, in append
  File "C:\Users\Zumo\anaconda3\envs\Flatland\lib\site-packages\numpy\lib\function_base.py", line 4671, in append
    return concatenate((arr, values), axis=axis)
  File "<__array_function__ internals>", line 6, in concatenate
KeyboardInterrupt